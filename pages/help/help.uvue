<template>
	<view class="help-page">
		<sg-navbar title="å¸®åŠ©ä¸­å¿ƒ" />
		
		<view class="help-search">
			<view class="help-search-wrap">
				<text class="help-search-icon">ğŸ”</text>
				<input 
					class="help-search-input"
					v-model="searchKeyword"
					placeholder="æœç´¢å¸¸è§é—®é¢˜"
					@confirm="searchHelp"
				/>
			</view>
		</view>
		
		<view class="help-quick">
			<text class="help-section-title">å¿«æ·å…¥å£</text>
			<view class="help-quick-list">
				<view class="help-quick-item" @click="goToOnlineService">
					<text class="help-quick-icon">ğŸ’¬</text>
					<text class="help-quick-text">åœ¨çº¿å®¢æœ</text>
				</view>
				<view class="help-quick-item" @click="makePhoneCall">
					<text class="help-quick-icon">ğŸ“</text>
					<text class="help-quick-text">ç”µè¯å’¨è¯¢</text>
				</view>
				<view class="help-quick-item" @click="goToFeedback">
					<text class="help-quick-icon">ğŸ“</text>
					<text class="help-quick-text">æ„è§åé¦ˆ</text>
				</view>
			</view>
		</view>
		
		<view class="help-faq">
			<text class="help-section-title">å¸¸è§é—®é¢˜</text>
			<view class="help-category" v-for="(category, cIndex) in faqList" :key="cIndex">
				<view class="help-category-header" @click="toggleCategory(cIndex)">
					<text class="help-category-icon">{{ category.icon }}</text>
					<text class="help-category-title">{{ category.title }}</text>
					<text class="help-category-arrow" :class="{ 'help-category-arrow--expanded': category.expanded }">â€?/text>
				</view>
				<view v-if="category.expanded" class="help-category-questions">
					<view 
						v-for="(question, qIndex) in category.questions" 
						:key="qIndex"
						class="help-question-item"
						@click="goToAnswer(question)"
					>
						<text class="help-question-text">{{ question.title }}</text>
						<text class="help-question-arrow">â€?/text>
					</view>
				</view>
			</view>
		</view>
	</view>
</template>

<script lang="uts">
	interface Question {
		id: number
		title: string
		answer: string
	}
	
	interface Category {
		title: string
		icon: string
		expanded: boolean
		questions: Question[]
	}
	
	export default {
		data() {
			return {
				searchKeyword: '',
				faqList: [
					{
						title: 'è´¦æˆ·ç›¸å…³',
						icon: 'ğŸ‘¤',
						expanded: true,
						questions: [
							{ id: 1, title: 'å¦‚ä½•æ³¨å†Œè´¦æˆ·ï¼?, answer: '' },
							{ id: 2, title: 'å¿˜è®°å¯†ç æ€ä¹ˆåŠï¼Ÿ', answer: '' },
							{ id: 3, title: 'å¦‚ä½•ä¿®æ”¹ç»‘å®šæ‰‹æœºï¼?, answer: '' },
							{ id: 4, title: 'å¦‚ä½•å®åè®¤è¯ï¼?, answer: '' }
						]
					},
					{
						title: 'äº¤æ˜“ç›¸å…³',
						icon: 'ğŸ’°',
						expanded: false,
						questions: [
							{ id: 5, title: 'å¦‚ä½•è´­ä¹°ç†è´¢äº§å“ï¼?, answer: '' },
							{ id: 6, title: 'å¦‚ä½•èµå›ç†è´¢äº§å“ï¼?, answer: '' },
							{ id: 7, title: 'äº¤æ˜“å¯†ç å¿˜è®°äº†æ€ä¹ˆåŠï¼Ÿ', answer: '' },
							{ id: 8, title: 'èµ„é‡‘åˆ°è´¦éœ€è¦å¤šä¹…ï¼Ÿ', answer: '' }
						]
					},
					{
						title: 'å®‰å…¨ç›¸å…³',
						icon: 'ğŸ”',
						expanded: false,
						questions: [
							{ id: 9, title: 'è´¦æˆ·å®‰å…¨å¦‚ä½•ä¿éšœï¼?, answer: '' },
							{ id: 10, title: 'å¦‚ä½•å¼€å¯æŒ‡çº¹ç™»å½•ï¼Ÿ', answer: '' },
							{ id: 11, title: 'å‘ç°å¼‚å¸¸äº¤æ˜“æ€ä¹ˆåŠï¼Ÿ', answer: '' }
						]
					},
					{
						title: 'äº§å“ç›¸å…³',
						icon: 'ğŸ“Š',
						expanded: false,
						questions: [
							{ id: 12, title: 'ä»€ä¹ˆæ˜¯é£é™©ç­‰çº§ï¼?, answer: '' },
							{ id: 13, title: 'æ”¶ç›Šæ˜¯å¦‚ä½•è®¡ç®—çš„ï¼?, answer: '' },
							{ id: 14, title: 'äº§å“æœ‰ä¿æœ¬ä¿æ¯å—ï¼?, answer: '' }
						]
					}
				] as Category[]
			}
		},
		methods: {
			searchHelp() {
				if (this.searchKeyword.trim()) {
					uni.showToast({ title: 'æœç´¢åŠŸèƒ½å¼€å‘ä¸­', icon: 'none' })
				}
			},
			
			toggleCategory(index: number) {
				this.faqList[index].expanded = !this.faqList[index].expanded
			},
			
			goToAnswer(question: Question) {
				uni.navigateTo({
					url: `/pages/help-detail/help-detail?id=${question.id}&title=${encodeURIComponent(question.title)}`
				})
			},
			
			goToOnlineService() {
				uni.navigateTo({ url: '/pages/online-service/online-service' })
			},
			
			makePhoneCall() {
				uni.makePhoneCall({
					phoneNumber: '400-888-8888',
					fail: () => {
						uni.showToast({ title: 'å®¢æœçƒ­çº¿ï¼?00-888-8888', icon: 'none' })
					}
				})
			},
			
			goToFeedback() {
				uni.navigateTo({ url: '/pages/feedback/feedback' })
			}
		}
	}
</script>

<style lang="scss">
	@import './help.scss';
</style>
